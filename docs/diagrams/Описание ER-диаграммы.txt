1.
-- Таблица поставщиков (Suppliers)
-- Хранит информацию о компаниях, у которых мы закупаем товары.
-- Наполнение:
    id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY
    name VARCHAR(255) NOT NULL UNIQUE
    contact_info TEXT 		-- Общая информация: телефон, email, адрес
    created TIMESTAMPTZ DEFAULT NOW()


2.
-- Таблица складов (Warehouses)
-- Хранит информацию о наших складах.
-- Наполнение:
    id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY
    name VARCHAR(255) NOT NULL UNIQUE
    location TEXT 		-- Адрес или описание местоположения
    created TIMESTAMPTZ DEFAULT NOW()


3.
-- Таблица товаров (Products)
-- Основной каталог наших товаров.
-- Наполнение:
    id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY
    sku VARCHAR(100) NOT NULL UNIQUE 	-- уникальный артикул
    name VARCHAR(255) NOT NULL
    supplier_id INT			-- Связь с поставщиком
    weight_kg DECIMAL(10,3) CHECK (weight_kg > 0)
    created TIMESTAMPTZ DEFAULT NOW()

-- Cвязь с таблицей поставщиков:
    CONSTRAINT fk_supplier
        FOREIGN KEY(supplier_id) 
        REFERENCES suppliers(id)
        ON DELETE SET NULL 	-- Если поставщик удален, товар останется без поставщика


4.
-- Промежуточная таблица остатков (Product Inventory) для связи N-к-N между Products и Warehouses
-- Показывает сколько единиц товара и на каком складе.
-- Наполнение:
    product_id_pi INT NOT NULL
    warehouse_id INT NOT NULL
    quantity INT NOT NULL CHECK (quantity >= 0)	 -- Остаток не может быть отрицательным
    last_updated TIMESTAMPTZ DEFAULT NOW()

-- Составной первичный ключ:
    PRIMARY KEY (product_id, warehouse_id)

-- Связи с таблицами товаров и складов:
    CONSTRAINT fk_product
        FOREIGN KEY(product_id) 
        REFERENCES products(id)
        ON DELETE CASCADE	-- Если товар удален, его остатки тоже удаляются
    CONSTRAINT fk_warehouse
        FOREIGN KEY(warehouse_id) 
        REFERENCES warehouses(id)
        ON DELETE CASCADE 	-- Если склад удален, остатки на нем удаляются


5.
-- Таблица продаж (Sales)
-- Журнал всех операций по продажам.
-- Наполнение:
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY	-- BIGINT, тк продаж может быть очень много
    product_id_s INT NOT NULL
    sale_date TIMESTAMPTZ NOT NULL
    quantity INT NOT NULL CHECK (quantity > 0)
    price DECIMAL(10, 2) NOT NULL CHECK (price >= 0)	-- Цена за единицу товара
    total_amount DECIMAL(12, 2) GENERATED ALWAYS AS (quantity * price) STORED	-- Вычисляемое поле общей суммы продажи

-- Связь с таблицей товаров:
    CONSTRAINT fk_product
        FOREIGN KEY(product_id) 
        REFERENCES products(id)
        ON DELETE RESTRICT	-- Запрещаем удалять товар, по которому были продажи